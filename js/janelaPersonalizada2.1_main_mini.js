/*
JANELA PERSONALIZADA 2.1 © 2022-2024
Desenvolvido por Reynolds Costa

O uso é permitido; a comercialização, proibida.
*/

/*
		 ---------------
Esse é o |==PRINCIPAL==| arquivo dessa biblioteca.
		 ---------------

AVISO:
Não altere se não souber o que está fazendo.
*/

let JP;const JP_evitaCallback=Math.random(),Janelas=function(){let e,o,t=this,n=new Array,a=new Array,r=new Array,l=!0,s=!1,c=!0,d=!1,u=null,m=null,f=null,b=new Array,h=new Array;this.lista=new Array,this.criar=new function(){const e=this;let o=function(e,o){return void 0===e&&(e=0),"number"!=typeof e?(console.error('O parâmetro "padrao", se declarado, deve ser um número'),0):parseInt(e)!=e?(console.error('O parâmetro "padrao", se declarado, deve ser um inteiro'),0):e<0||e>o?(console.error("O botão indicado por "+e+" não existe"),0):e};this.principal=function(e){return new X(e)},this.alerta=function(o,n,i){let a=!1;void 0===i?i=function(e){}:A("callback",i,"function",!0,!1,!0)||(a=!0),void 0===n?n="Aviso":A("_titulo",n,"string",!0,!1,!1)?n||(n="Aviso"):a=!0;let r=t.recursos.botaoPadrao();return!a&&(r.funcao=function(){t.manutencao.fechar()},e.principal({id:"alerta",conteudo:{cabecalho:{titulo:n,botoes:{maximizar:!1,fechar:function(){i()}}},corpo:"<p>"+o+"</p>",botaoPadrao:0,botoes:[{Ok:r}]},estilo:{maximizar:!1},config:{fechar:{mouse:!1,teclado:!0}}}))},this.confirma=function(n,i,a,r,l){if(A("callback",r,"function",!1,!1,!0)&&A("cancelar",a,"boolean",!1,!1,!0)&&A("_titulo",i,"string",!1,!1,!1)&&A("_conteudo",n,"string",!1,!1,!0)){i||(i="Confirmar");let s=t.recursos.botaoPadrao(),c=w(s);s.letra=0;let d=w(s);s.funcao=function(){r(M({confirma:1}).confirma),t.manutencao.fechar(JP_evitaCallback)},d.funcao=function(){r(M({confirma:0}).confirma),t.manutencao.fechar(JP_evitaCallback)},c.funcao=function(){r(M({confirma:-1}).confirma),t.manutencao.fechar(JP_evitaCallback)};let u=[{Sim:s},{"Não":d}];return a&&u.push({Cancelar:c}),e.principal({id:"confirma",conteudo:{cabecalho:{titulo:i,botoes:{maximizar:!1,fechar:a?function(){r(M({confirma:-1}).confirma)}:-1}},corpo:"<p>"+n+"</p>",botoes:u,botaoPadrao:o(l,a?2:1)},estilo:{maximizar:!1},config:{fechar:{mouse:!1,teclado:a}}})}return!1},this.prompt=function(n,i,a,r,l,s,c){if(A("callback",s,"function",!1,!1,!0)&&A("validar",l,"function",!1,!1,!0)&&A("cancelar",r,"boolean",!1,!1,!0)&&A("_titulo",a,"string",!1,!1,!1)&&A("placeholder",i,"string",!1,!1,!1)&&A("_conteudo",n,"string",!1,!1,!0)){a||(a="Inserindo dados");let d=t.recursos.botaoPadrao(),u=w(d);u.funcao=function(){t.manutencao.fechar()},d.funcao=function(){f=t.recursos.obterUltimo("ativo");let o=document.querySelector("#"+f+" #prompt").value,n=l(o);"string"==typeof n?(t.manutencao.fechar(),n?null===m?m=e.alerta(n,"",(function(){setTimeout((function(){t.manutencao.reabrir(f),f=null}),0)})):m.set.reabrir():(s(M({prompt:o}).prompt),f=null,m=null)):console.error("A função de validação deve retornar uma string")};let b=[{Ok:d}];return r&&b.push({Cancelar:u}),e.principal({id:"prompt",conteudo:{cabecalho:{titulo:a,botoes:{maximizar:!1,fechar:r?function(){}:-1}},corpo:"<p>"+n+"</p><input type = 'text' id = 'prompt' style = 'width:100%;margin-bottom:10px' value = '"+i+"' />",botoes:b,botaoPadrao:o(c,r?1:0)},estilo:{maximizar:!1},config:{fechar:{mouse:!1,teclado:r}}})}return!1}},this.alterar=new function(){this.editar=function(e,o){if(A("obj",o,"object",!1,!1,!1)&&P(e,"editar",!1,!0)){let n=L(o,t.lista[e].objeto),i=document.getElementById(e),a=t.lista[e];if(l&&(void 0===r[e]&&(r[e]=new Array),r[e].push(w(a.objeto))),a.objeto=w(n),a.btnTopo=0,n.estilo.branco?i.classList.add("is-bright"):i.classList.remove("is-bright"),"object"==typeof o.conteudo){const t=o.conteudo;"string"==typeof t.cabecalho.titulo&&(document.querySelector("#"+e+" .title-bar-text").innerHTML=n.conteudo.cabecalho.titulo),"string"==typeof t.corpo&&(document.getElementById(e+"-corpo").innerHTML=n.conteudo.corpo),"object"==typeof t.botoes&&(document.querySelector("#"+e+" footer").innerHTML=k(n.conteudo.botoes,e))}let s=n.conteudo.cabecalho.botoes;document.getElementById(e+"-maxmin").style.display=s.maximizar?"":"none",document.getElementById(e+"-close").style.display="function"!=typeof s.fechar?"none":"",s.maximizar&&a.btnTopo++,"function"==typeof s.fechar&&a.btnTopo++;let c=!1;"object"==typeof o.estilo&&(c=["object","string"].indexOf(typeof o.estilo.posicao)>-1||"object"==typeof o.estilo.dimensoes),F(n,e,c),U(t.recursos.obterUltimo("ativo"))}},this.limparEdicoes=function(e,o){if(P(e,"limpar as edições de",!1,!0))try{let n=void 0!==o?r[e].length-o:0;if(void 0!==r[e][n]){l=!1,t.alterar.editar(e,r[e][n]);let o=new Array;for(let t=0;t<n;t++)o.push(r[e][t]);r[e]=o,setTimeout((function(){l=!0}),0)}else console.error(void 0===o?"Não houveram edições feitas nesssa janela":"O número não corresponde a uma quantidade de edições válida")}catch(e){console.error("Não houveram edições feitas nessa janela")}},this.botaoOnOff=function(e,o,n){if(P(e,"manipular o botão de uma",!1,!0))try{const a=t.lista[e].objeto.conteudo;let r=a.botoes,l=[0,""];switch(typeof o){case"string":l[1]=o,r.forEach((e=>{for(x in e)x==o&&(l[0]=i)}));break;case"number":l=[o,O(r[o]).nome]}if(a.botaoPadrao!=l[0]){let o=!0,t=r[l[0]][l[1]];if(void 0===n?(o=!1,n=!t.ativo):A("ativar",n,"boolean",!1,!1,!1)&&(o=!1),!o){if(t.ativo!=n){let o=document.querySelectorAll("#"+e+" footer button");t.ativo=n,o[l[0]].disabled=!n}else console.warn("O botão já estava "+(n?"":"in")+"ativo");n||q()}}else console.error("Não é possível manipular o botão padrão de uma janela.")}catch(e){console.error("O botão indicado não existe")}}},this.recursos=new function(){this.botaoPadrao=function(){return O(w(JP_preferencias.conteudo.botoes[0])).objeto},this.obterUltimo=function(e){let o="";if(["ativo","aberto"].indexOf(e)>-1)for(x in t.lista)t.lista[x][e]&&(o=x);else console.error('O tipo deve ser "ativo" ou "aberto"');return o},this.zIndex=function(e){let o=-1;if(void 0===e)for(x in t.lista)t.lista[x].zIndex>o&&(o=t.lista[x].zIndex);else P(e,"conhecer informações de",!1,!1)&&(o=t.lista[e].zIndex);return-1!=o&&o},this.maxmin=function(e){return P(e,"conhecer informações de",!1,!1),n.indexOf(I(e))>-1}},this.manutencao=new function(){this.maxmin=function(e,o){if(P(e,"maximizar ou restaurar",!0,!0)){"number"==typeof e&&(e=E(e));let r=!1;if(void 0!==o&&(r=!A("maximizado",o,"boolean",!0,!1,!0)),t.recursos.obterUltimo("ativo")==e&&!r){const r=t.lista[e],l=r.objeto.config,s=document.getElementById("JP-estilo");let d=document.getElementById(e),u=d.style;if(r.objeto.conteudo.cabecalho.botoes.maximizar)var i="Maximize"!=(a=document.getElementById(e+"-maxmin")).getAttribute("aria-label");else{var a=null;i=n.indexOf(e)>-1}if(void 0===o&&(o=i),["top","left","width","height"].forEach((e=>{u.removeProperty(e)})),o)null!==a&&a.setAttribute("aria-label","Maximize"),n.splice(n.indexOf(e),1),l.mover&&d.classList.add("draggable"),s.innerHTML+="#"+e+"{width  : "+r.dimensoes[0]+"px;height : "+r.dimensoes[1]+"px}",c=!1,setTimeout((function(){c=!0}),100);else{const o=v(),t=B();s.innerHTML+="#"+e+"{top    : 50%;left   : 50%;width  : "+Math.min(o.width,t.largura)+"px;height : "+Math.min(o.height,t.altura)+"px}",null!==a&&a.setAttribute("aria-label","Restore"),l.mover&&d.classList.remove("draggable"),n.push(e)}setTimeout((function(){N(e,!1)}),100)}}},this.fechar=function(e){const o=e!==JP_evitaCallback;(e=o?I(e):I())==t.recursos.obterUltimo("ativo")&&c&&(H(e),S(!0),c=!1,setTimeout((function(){if(c=!0,o){const o=t.lista[e].objeto.conteudo.cabecalho.botoes.fechar;"function"==typeof o&&o(),Array.from(document.querySelectorAll(".menuRes > main, .menuRes > footer")).forEach((e=>{e.style.removeProperty("z-index")}))}}),100)),t.recursos.obterUltimo("aberto")?U(t.recursos.obterUltimo("aberto")):(Array.from(document.querySelectorAll("button")).forEach((e=>{e.disabled=!1})),p()&&(document.getElementById("menuCobrir").style.display="none"))},this.reabrir=function(e){try{"object"==typeof e&&(e=e.id),e=I(e),P(e,"reabrir",!1,!1)&&(document.getElementById(e).style.display="block",t.lista[e].aberto=!0,_(e))}catch(e){}},this.ativar=function(e){P(e,"ativar",!1,!0)&&(_(e),e!=t.recursos.obterUltimo("ativo")&&(setTimeout((function(){q()}),50),setTimeout((function(){S(!1)}),100)))}},this._controle=new function(){let e=function(){let e=!1;if(q(),s)e=!0;else{const e=t.lista[t.recursos.obterUltimo("ativo")].objeto.conteudo.botaoPadrao,o=z();o.indexOf(e)>-1?R(e,!0):o.length&&R(o[o.length-1],!0)}return s=!s,e};this.click=function(e){let o=!0;const n=t.recursos.obterUltimo("ativo");if(JP_mult){let e=new Array;for(x in t.lista)t.lista[x].aberto&&e.push(x);e.forEach((e=>{document.getElementById(e).contains(event.target)&&(_(e),o=!1)}))}if(o){const e=document.getElementById(n);null!==e&&(o=j(!e.contains(event.target),"mouse"))}return o},this.keyup=function(o){return 27==o.keyCode&&(s?(e(),!0):j(!0,"teclado"))},this.keydown=function(o){let n=!t.recursos.obterUltimo("aberto");if(!n){const n=t.recursos.obterUltimo("ativo");let i=t.lista[n];if([18,37,39].indexOf(o.keyCode)>-1){(18==o.keyCode||i.sel>-1)&&o.preventDefault();const t=i.objeto.conteudo;if([37,39].indexOf(o.keyCode)>-1&&i.sel>-1){const e=t.botoes;let n=new Array;for(let o=0;o<e.length;o++)O(e[o]).objeto.ativo&&n.push(o);let a=n.indexOf(i.sel)+o.keyCode-38;a<0?a=n.length-1:a>n.length-1&&(a=0);let r=n[a];r<n[0]?r=n[n.length-1]:r>n[n.length-1]&&(r=n[0]),q(),R(r,!1),s&&z()}else 18==o.keyCode&&e()&&(a=new Array)}else 13==o.keyCode&&i.sel>-1&&i.objeto.conteudo.botoes.length?document.getElementById(n+"_btn"+i.sel).onclick():void 0!==a[o.keyCode]&&a[o.keyCode]()}return n},this.resize=function(){v(),B();for(x in t.lista){let e=t.lista[x].dataEstilo,o=document.getElementById(x);n.indexOf(x)>-1?(o.style.opacity="0",t.manutencao.maxmin(x),setTimeout((function(){t.manutencao.maxmin(x)}),300),setTimeout((function(){o.style.removeProperty("opacity")}),500)):document.querySelector("#"+x+" .title-bar-text").style.removeProperty("margin-right"),e.length&&W(x,document.getElementById("JP-mov-"+x),10*e[1],10*e[0],o.offsetHeight,o.offsetWidth)}},this.executarFuncao=function(e,o){const n=E(e);if(t.recursos.obterUltimo("ativo")==n){const e=O(t.lista[n].objeto.conteudo.botoes[o]).objeto;e.ativo&&e.funcao()}}},setTimeout((function(){g().innerHTML+="<style type = 'text/css' id = 'JP-estilo'>.janela {position: fixed;transform: translate(-50%, -50%);width: max-content}</style>",p()?document.getElementById("menuRes").addEventListener("scroll",J):document.addEventListener("scroll",J)}),0);let p=function(){let e=!0;try{void 0===WLM&&(e=!1)}catch(o){e=!1}return e},g=function(){return p()?document.getElementById("menuRes"):document.body},v=function(){const e=p();let o=document.getElementById("menuRes"),t=document.getElementById(JP_pai);if(d||""==JP_pai||null!==t||(console.warn('O elemento "'+JP_pai+'" não pôde ser configurado em JP_pai pois ele não existe\nAs janelas serão criadas de forma livre'),d=!0),null!==t&&e){t=t.getBoundingClientRect(),o=o.getBoundingClientRect();var n={top:Math.max(t.top,o.top),left:Math.max(t.left,o.left),height:Math.min(t.height,o.height),width:Math.min(t.width,o.width)}}else if(null!==t||e){const e=null!==t?t.getBoundingClientRect():o.getBoundingClientRect();n={top:e.top,left:e.left,height:e.height,width:e.width}}else n={top:0,left:0,height:window.innerHeight,width:window.innerWidth};return n},j=function(e,o){const n=t.recursos.obterUltimo("ativo");return n&&e&&(t.lista[n].objeto.config.fechar[o]?t.manutencao.fechar():C()),!t.recursos.obterUltimo("aberto")},w=function(e){let o=e.constructor===Array?[]:{};for(x in e){let t=e[x];o[x]="object"==typeof t?w(t):t}return o},E=function(e){let o;for(x in b)if(b[x]==e){o=x;break}return o},I=function(e){const o=e;void 0!==e?"number"==typeof e&&(e=E(e)):e=t.recursos.obterUltimo("ativo");const n=t.recursos.obterUltimo("aberto");return e||(e=n),!e&&n?(void 0===o?console.error("É necessário informar um id"):console.error('A janela "'+o+'" não existe'),!1):e},A=function(e,o,t,n,i,a){t.constructor!==Array&&(t=[t]);let r=t.indexOf(typeof o)>-1;n&&(r=r||void 0===o);let l="";for(let e=0;e<t.length;e++)l+=t[e],e<t.length-1&&(l+=e<t.length-2?", ":" ou ");let s=i?'A chave "':'O parâmetro "';return s+=e+'"',n&&(s+=", se definid",s+=i?"a":"o",s+=","),s+=" deve ser ",r?"string"!=typeof o||a?"number"==typeof o&&(parseInt(o)==o?(e.indexOf("altura")>-1||e.indexOf("largura")>-1)&&o&&o<150&&(r=!1,s+="um inteiro igual a 0 ou maior ou igual 150",console.error(s)):(r=!1,s+="um inteiro",console.error(s))):o.indexOf("<")>-1&&o.indexOf(">")>-1&&(r=!1,s+="do tipo "+l+" e não possuir tags HTML",console.error(s)):(s+="do tipo "+l,console.error(s)),r&&void 0!==o},P=function(e,o,n,i){let a=!1;return void 0!==e?(n&&"number"==typeof e&&(e=E(e)),"string"==typeof e?void 0!==t.lista[e]?i?t.lista[e].aberto?a=!0:T()?console.error("As janelas não podem ser construídas se o elemento pai não estiver visível"):console.error("Não é possível "+o+" uma janela que não está aberta"):a=!0:console.error('A janela "'+e+'" não existe'):console.error('O parâmetro "id" deve ser do tipo string')):console.error('O parâmetro "id" não foi definido'),a},B=function(){return{altura:Math.min(g().offsetHeight,window.innerHeight),largura:Math.min(g().offsetWidth,window.innerWidth)}},T=function(){const e=v();return e.top>B().altura||e.top+e.height<0},O=function(e){for(x in e)var o={nome:x,objeto:e[x]};return o},z=function(){const e=t.recursos.obterUltimo("ativo"),o=t.lista[e].objeto.conteudo.botoes;let n=new Array,i=new Array;for(let e=0;e<o.length;e++){let t=O(o[e]).objeto;t.letra>-1&&t.ativo&&(n.push(e),i.push(t.letra))}for(let o=0;o<n.length;o++){let t=document.getElementById(e+"_btn"+n[o]),r=t.innerHTML.substring(i[o],i[o]+1);a[65+"ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(r.toUpperCase())]=t.onclick;let l=t.innerHTML.substring(0,i[o])+"<span style = 'text-decoration:underline'>"+r+"</span>"+t.innerHTML.substring(i[o]+1);t.innerHTML=l}return n},L=function(e,o){let t=e,n="obj",i=w(void 0===o?JP_preferencias:o);if(A(n+".conteudo",t.conteudo,"object",!0,!0,!0)&&(t=t.conteudo,n+=".conteudo",A(n+".cabecalho",t.cabecalho,"object",!0,!0,!0)&&(t=t.cabecalho,n+=".cabecalho",A(n+".titulo",t.titulo,"string",!0,!0,!1)&&(i.conteudo.cabecalho.titulo=t.titulo),A(n+".botoes",t.botoes,"object",!0,!0,!0)&&(t=t.botoes,n+=".botoes",A(n+".maximizar",t.maximizar,"boolean",!0,!0,!0)&&(i.conteudo.cabecalho.botoes.maximizar=t.maximizar),void 0!==t.fechar&&(i.conteudo.cabecalho.botoes.fechar=t.fechar))),t=e.conteudo,n="obj.conteudo",A(n+".corpo",t.corpo,"string",!0,!0,!0)&&(i.conteudo.corpo=t.corpo),void 0!==e.conteudo.botoes)){let o=!1;if(e.conteudo.botoes.constructor===Array){new Array;e.conteudo.botoes.forEach((e=>{if("object"!=typeof e||o)o=!0;else{let t=O(e).objeto;("object"!=typeof t||o||"function"!=typeof t.funcao||"number"!=typeof t.letra||"boolean"!=typeof t.ativo||"string"!=typeof t.descr||parseInt(t.letra)!=t.letra||t.descr.indexOf("<")>-1&&t.descr.indexOf(">")>-1||t.letra<-1||t.letra>O(e).nome.length)&&(o=!0)}}))}else o=!0;o?console.error("Ocorreu um erro na construção dos botões dessa janela"):(i.conteudo.botoes=e.conteudo.botoes,A(n+".botaoPadrao",t.botaoPadrao,"number",!0,!0,!0)&&(t.botaoPadrao>=-1&&t.botaoPadrao<i.conteudo.botoes.length?i.conteudo.botaoPadrao=t.botaoPadrao:console.error('A chave "'+n+'.botaoPadrao", se definida, deve ser um inteiro entre -1 e a quantidade de botoes - 1')))}if(A("obj.estilo",e.estilo,"object",!0,!0,!0)&&(t=e.estilo,n="obj.estilo",A(n+".maximizar",t.maximizar,"boolean",!0,!0,!0)&&(i.estilo.maximizar=t.maximizar),A(n+".branco",t.branco,"boolean",!0,!0,!0)&&(i.estilo.branco=t.branco),A(n+".dimensoes",t.dimensoes,"object",!0,!0,!0)&&(t=t.dimensoes,n+=".dimensoes",A(n+".altura",t.altura,"number",!0,!0,!0)&&(i.estilo.dimensoes.altura=t.altura),A(n+".largura",t.largura,"number",!0,!0,!0)&&(i.estilo.dimensoes.largura=t.largura)),t=e.estilo,A(n+".posicao",t.posicao,["string","object"],!0,!0,!1)&&void 0!==t.posicao))if(n+=".posicao","object"==typeof t.posicao){if(t=t.posicao,void 0!==t.horizontal)if(["esquerda","centro","direita"].indexOf(t.horizontal)>-1)var a=t.horizontal;else console.error('A chave "'+n+'.horizontal", se definida, deve ser do tipo string e ser igual a "esquerda", "centro" ou "direita"');if(void 0!==t.vertical)if(["acima","centro","abaixo"].indexOf(t.vertical)>-1)var r=t.vertical;else console.error('A chave "'+n+'.vertical", se definida, deve ser do tipo string e ser igual a "acima", "centro" ou "abaixo"');i.estilo.posicao={},i.estilo.posicao.horizontal=void 0!==a&&a,i.estilo.posicao.vertical=void 0!==r&&r}else"auto"==t.posicao?i.estilo.posicao=t.posicao:console.error('A chave "'+n+'", se definida, deve ser do tipo object ou uma string igual a "auto"');return A("obj.config",e.config,"object",!0,!0,!0)&&(t=e.config,n="obj.config",A(n+".mover",t.mover,"boolean",!0,!0,!0)&&(i.config.mover=t.mover),A(n+".fechar",t.fechar,"object",!0,!0,!0)&&(t=t.fechar,n+=".fechar",A(n+".mouse",t.mouse,"boolean",!0,!0,!0)&&(i.config.fechar.mouse=t.mouse),A(n+".teclado",t.teclado,"boolean",!0,!0,!0)&&(i.config.fechar.teclado=t.teclado))),i},k=function(e,o){let t="",n=b[o];for(let i=0;i<e.length;i++){let a=O(e[i]).objeto,r=a.descr?" title = '"+a.descr+"'":"",l=a.ativo?"":" disabled";t+="<button onclick = 'JP._controle.executarFuncao("+[n,i].join(",")+")' id = '"+o+"_btn"+i+"'"+r+l+">"+x+"</button>"}return t},M=function(e,o){if(A("json",e,"object",!1,!1,!0)){o=I(o);let t=new Array;for(x in e)t[x]=e[x];return h[o]=t,t}return!1};const C=function(){c&&(u=document.getElementById(t.recursos.obterUltimo("ativo")).classList,u.add("glass"),setTimeout((function(){u.remove("glass")}),50),setTimeout((function(){u.add("glass")}),100),setTimeout((function(){u.remove("glass")}),150))},H=function(e){t.lista[e].aberto=!1,t.lista[e].ativo=!1,t.lista[e].sel=-1,n.splice(n.indexOf(e),1),document.getElementById(e).style.display="none"},J=function(){const e=T();let o=0;for(x in t.lista)if(t.lista[x].aberto){if(e){H(x);const e=t.lista[x].objeto.conteudo.cabecalho.botoes.fechar;"function"==typeof e&&e(),p()&&(document.getElementById("menuCobrir").style.display="none")}else N(x,!1);o++}if(e&&(Array.from(document.querySelectorAll("button")).forEach((e=>{e.disabled=!1})),o>0)){let e=1==o?"A janela":"As janelas";e+=" não ",e+=1==o?"pôde":"puderam",e+=" ser redimensionada",o>1&&(e+="s"),e+=" no espaço destinado a ela",o>1&&(e+="s"),e+=" e ",e+=1==o?"foi":"foram",e+=" fechada",o>1&&(e+="s"),null!==document.getElementById(JP_pai)&&(e+="\nEscolha um elemento pai diferente"),console.warn(e)}},U=function(e){let o=e!=t.recursos.obterUltimo("ativo");for(x in Array.from(document.querySelectorAll("button")).forEach((e=>{e.disabled=!0})),t.lista)if(Array.from(document.querySelectorAll("#"+x+" *")).forEach((e=>{e.disabled=!1})),Array.from(document.querySelectorAll("#"+x+(JP_mult?" footer":"")+" *, #"+x+" button, #"+x+" input[type=checkbox]")).forEach((o=>{o.disabled=x!=e,x!=e&&"BUTTON"==o.tagName&&o.classList.remove("focado")})),t.lista[x].ativo=x==e,document.getElementById(x).classList.remove("active"),x==e){lista=document.querySelectorAll("#"+x+" footer button");for(let o=0;o<lista.length;o++)lista[o].disabled=!O(t.lista[e].objeto.conteudo.botoes[o]).objeto.ativo}o&&S(!0),document.getElementById(e).classList.add("active");let n=2;for(x in t.lista){let e;if(t.lista[x].aberto?(e=n,n+=1):e=0,t.lista[x].zIndex=e,document.getElementById(x).style.zIndex=e,p()){document.getElementById("menu").style.zIndex=e+1;let o=document.getElementById("menuCobrir").style;o.display="block",o.zIndex=e+2,document.getElementById("menuRes").style.zIndex=1}}},_=function(e){setTimeout((function(){if(e=I(e)){let o=t.lista[e];delete t.lista[e],t.lista[e]=o,U(e)}}),50)},q=function(){for(x in t.lista){let o=t.lista[x];if(o.aberto){let t=o.objeto.conteudo.botoes;for(let o=0;o<t.length;o++){let n=document.getElementById(x+"_btn"+o);for(y in n.classList.remove("focado"),t[o])var e=y;n.innerHTML=e}o.sel=-1}}},R=function(e,o){const n="Foi solicitado um botão que não ";let i=t.recursos.obterUltimo("ativo"),a=t.lista[i];const r=a.objeto.conteudo.botoes;if(e>-1&&e<r.length){let l=new Array;for(let e=0;e<r.length;e++)O(r[e]).objeto.ativo&&l.push(e);l.indexOf(e)>-1?setTimeout((function(){try{i=t.recursos.obterUltimo("ativo"),a=t.lista[i],a.sel=e,document.getElementById(i+"_btn"+a.sel).classList.add("focado")}catch(e){}}),o?100:0):console.error(n+"está ativo.")}else console.error(n+"existe.")},S=function(e){setTimeout((function(){const o=t.recursos.obterUltimo("ativo");if(o){const n=t.lista[o].objeto.conteudo.botaoPadrao;n>-1&&(q(),R(n,e))}}),0)},W=function(e,o,n,i,a,r){const l="JP-estilo"==o.id;l&&(5==n&&(a=0),5==i&&(r=0));const s="#"+e+"{top  : calc("+10*n+"% "+(n<5||!l?"+":"-")+" "+a/2+"px);left : calc("+10*i+"% "+(i<5||!l?"+":"-")+" "+r/2+"px)}";if(l)for(x in o.innerHTML+=s,t.lista){let e=document.getElementById("JP-mov-"+x);null!==e&&(e.innerHTML="")}else o.innerHTML=s},N=function(e,o){const n=document.getElementById(e),i=getComputedStyle(n),a=t.lista[e].dimensoes;let r=n.style,l=v(),s={top:parseInt(i.top.replace("px","")),left:parseInt(i.left.replace("px","")),width:parseInt(i.width.replace("px","")),height:parseInt(i.height.replace("px",""))};s.top-=s.height/2,s.left-=s.width/2;const c=s.top<l.top||s.top<0,d=s.left<l.left||s.left<0,u=s.width<a[0],m=s.height<a[1],f=s.left+s.width>l.left+l.width,b=s.top+s.height>l.top+l.height;l.top<0&&(l.top=0),l.left<0&&(l.left=0);const h=!f&&!b;r.removeProperty("top"),r.removeProperty("left"),r.visibility=o?"":"hidden",u?r.width=a[0]+"px":f&&(!d&&s.left-10>l.left?r.left=s.left-10+"px":r.width=s.width-10+"px"),m?r.height=a[1]+"px":b&&(!c&&s.top-10>l.top?r.top=s.top-10+"px":r.height=s.height-10+"px"),c&&(r.top=l.top+s.height/2+"px"),d&&(r.left=l.left+s.width/2+"px"),o||setTimeout((function(){N(e,h)}),h?100:0)},F=function(i,a,r){let l=document.getElementById("JP-estilo"),s=document.getElementById(a),c=document.getElementById(a+"-maxmin"),d=document.getElementById(a+"-close").style,u=t.lista[a],m=i.estilo.dimensoes,f=0,b=0,h=new Array,p=new Array;const g=m.altura>=150?m.altura:s.offsetHeight,y=m.largura>=150?m.largura:s.offsetWidth;for(x in t.lista){let e=t.lista[x];e.aberto&&(h.push(e.posicao[0]),p.push(e.posicao[1]),f++)}if(r){if("object"==typeof i.estilo.posicao){let e=i.estilo.posicao;switch(e.vertical){case"acima":var j=0;break;case"centro":j=5;break;case"abaixo":j=10}switch(e.horizontal){case"esquerda":var w=0;break;case"centro":w=5;break;case"direita":w=10}void 0!==j&&b++,void 0!==w&&b++}if(b<2){if(f>1){const e=void 0===j,o=void 0===w;let t=0;do{e&&(j=Math.floor(9*Math.random())+1),o&&(w=Math.floor(9*Math.random())+1),t++}while((h.indexOf(j)>-1&&e||p.indexOf(w)>-1&&o)&&t<10);t>=10&&console.warn("Há muitas janelas abertas, isso pode provocar lentidão.")}else void 0===j&&(j=5),void 0===w&&(w=5);W(a,l,j,w,g,y)}else W(a,l,j,w,g,y)}switch(m.altura>=150&&(l.innerHTML+="#"+a+"{height : "+m.altura+"px}"),l.innerHTML+=m.largura<=150?"#"+a+" .title-bar-text{margin-right:"+(35+100*(i.conteudo.botoes.length-1)+(135-50*u.btnTopo))+"px}":"#"+a+"{width : "+m.largura+"px}",u.posicao=[j,w],m=c.parentElement.style,c=c.style,m.visibility=u.btnTopo?"":"hidden",u.dimensoes=[y,g],u.btnTopo){case 1:u.objeto.conteudo.cabecalho.botoes.maximizar?(m.borderRightWidth="0px",c.borderBottomRightRadius="5px"):d.borderBottomLeftRadius="5px";break;case 2:m.removeProperty("border-right-width"),d.removeProperty("border-bottom-left-radius"),c.removeProperty("border-bottom-right-radius")}i.config.mover?s.classList.add("draggable"):s.classList.remove("draggable"),Array.from(document.querySelectorAll(".janela .title-bar")).forEach((e=>{let o=e.parentElement.id;t.lista[o].objeto.conteudo.cabecalho.botoes.maximizar&&(e.ondblclick=function(){t.lista[o].objeto.conteudo.cabecalho.botoes.maximizar&&t.manutencao.maxmin(o)})})),Array.from(document.getElementsByClassName("janela")).forEach((i=>{let a=i.id,r=t.lista[a],l=i.firstElementChild;i.className.indexOf("draggable")>-1?(l.onmousedown=function(l){let s=!1;Array.from(document.getElementsByClassName("title-bar-controls")).forEach((e=>{e.contains(l.target)&&(s=!0)})),-1!=n.indexOf(a)||s||t.recursos.obterUltimo("ativo")!=a||(r.movendo=!0,e=l.clientX-i.offsetWidth/2-i.getBoundingClientRect().left,o=-.5169492*i.offsetHeight+18)},l.onmouseout=function(){r.movendo=!1}):l.onmousedown=function(){},document.addEventListener("mousemove",(t=>{if(r.movendo&&r.objeto.config.mover){let n=v(),l=t.clientX-e,s=t.clientY-o,c=i.offsetWidth/2;if(l>=c){let e=window.innerWidth-c;l>e&&(l=e)}else l=c;for(;l+c>n.left+n.width;)l--;for(;l-c<n.left;)l++;let d=(l-c)/window.innerWidth;if(c=i.offsetHeight/2,s>=c){let e=window.innerHeight-c;s>e&&(s=e)}else s=c;for(;s+c>n.top+n.height;)s--;for(;s-c<n.top;)s++;let u=(s-c)/window.innerHeight;r.dataEstilo=[d,u],W(a,document.getElementById("JP-mov-"+a),10*u,10*d,i.offsetHeight,i.offsetWidth)}})),document.addEventListener("mouseup",(()=>{r.movendo=!1}))})),J(),setTimeout((function(){t.manutencao.ativar(a),S(!0),N(a,!1)}),100)},X=function(e){let o,n=function(e){let t=!1;return void 0===o?console.error("Não é possível "+e+" uma janela na mesma função que a criou."):t=!0,t};setTimeout((function(){if(o="",A("obj",e,"object",!0,!0,!0)){let n=L(e);if(void 0===e.id&&(e.id="janela"),"string"==typeof e.id){let i=1;for(x in t.lista)x==e.id+i&&i++;let a=e.id+i;if(t.lista[a]={aberto:!0,ativo:!0,movendo:!1,posicao:[],dataEstilo:[],dimensoes:[],btnTopo:0,zIndex:0,sel:-1,objeto:w(n)},void 0===b[a]){for(x in i=0,b)i++;b[a]=i}let r=t.lista[a],l=n.conteudo.botoes;const s=l.length?"":"sem-botoes";o=a;let c=document.createElement("div");if(c.id=a,c.classList.add("janela"),n.estilo.branco&&c.classList.add("is-bright"),c.innerHTML="<div class = 'title-bar'><div class = 'title-bar-text'>"+n.conteudo.cabecalho.titulo+"</div><div class = 'title-bar-controls'><button id = '"+a+"-maxmin' aria-label = 'Maximize' style = 'display:none' onclick = 'JP.manutencao.maxmin("+i+")'></button><button id = '"+a+"-close'aria-label = 'Close' style = 'display:none' onclick = 'JP.manutencao.fechar("+i+")'></button></div></div><div class = 'window-body "+s+"' id = '"+a+"-corpo'>"+n.conteudo.corpo+"</div><footer class = '"+s+"'>"+k(l,a)+"</footer>",g().appendChild(c),c=document.createElement("style"),c.id="JP-mov-"+a,g().appendChild(c),l=n.conteudo.cabecalho.botoes,l.maximizar&&(document.getElementById(a+"-maxmin").style.display="",r.btnTopo++),"function"==typeof l.fechar&&(document.getElementById(a+"-close").style.display="",r.btnTopo++),F(n,a,!0),n.estilo.maximizar){let e=document.getElementById(a).style;e.visibility="hidden",setTimeout((function(){e.removeProperty("visibility"),t.manutencao.maxmin(a)}),150)}}else console.error('O parâmetro "obj.id" deve ser do tipo string')}}),0),this.set=new function(){this.editar=function(e){n("editar")&&t.alterar.editar(o,e)},this.limparEdicoes=function(e){n("limpar as edições de")&&t.alterar.limparEdicoes(o,e)},this.ativar=function(){n("ativar")&&t.manutencao.ativar(o)},this.fechar=function(){n("fechar")&&t.manutencao.fechar(o)},this.reabrir=function(){n("reabrir")&&t.manutencao.reabrir(o)},this.maxmin=function(e){n("maximizar ou restaurar")&&t.manutencao.maxmin(o,e)},this.botaoOnOff=function(e,i){n("ativar ou desativar um botao de")&&t.alterar.botaoOnOff(o,e,i)}},this.get=new function(){const e="conhecer informações de";this.id=function(){return n(e)?o:""},this.zIndex=function(){return n(e)?t.recursos.zIndex(o):-1},this.maxmin=function(){return n(e)?t.recursos.maxmin(o):null}}}};

// Aqui termina o código PRINCIPAL